(* Content-type: application/vnd.wolfram.mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Mathematica 10.3' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       158,          7]
NotebookDataLength[     54469,       1401]
NotebookOptionsPosition[     53574,       1363]
NotebookOutlinePosition[     53929,       1379]
CellTagsIndexPosition[     53886,       1376]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{

Cell[CellGroupData[{
Cell["Covmat Derivative", "Title",
 CellChangeTimes->{{3.673641232136128*^9, 3.673641236352269*^9}}],

Cell[CellGroupData[{

Cell["Analytical Integration of 1D dcov_i", "Chapter",
 CellChangeTimes->{{3.6736413181807632`*^9, 3.673641335727269*^9}, {
  3.673641370552421*^9, 3.673641374309511*^9}}],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"mysinc", "[", "x_", "]"}], ":=", 
  RowBox[{
   RowBox[{"Sin", "[", 
    RowBox[{"\[Pi]", " ", "x"}], "]"}], "/", 
   RowBox[{"(", 
    RowBox[{"\[Pi]", " ", "x"}], ")"}]}]}], "\[IndentingNewLine]", 
 RowBox[{"Simplify", "[", " ", 
  RowBox[{"Integrate", "[", 
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{
       RowBox[{"(", 
        RowBox[{"\[Delta]t", "  ", 
         RowBox[{"mysinc", "[", 
          RowBox[{"\[Delta]t", " ", 
           RowBox[{"kt", "/", 
            RowBox[{"(", 
             RowBox[{"2", " ", "\[Pi]"}], ")"}]}]}], "]"}]}], ")"}], "^", 
       "2"}], "/", 
      RowBox[{"(", 
       RowBox[{"2", "\[Pi]"}], ")"}]}], " ", "2", " ", 
     RowBox[{"Cos", "[", " ", 
      RowBox[{"kt", " ", "\[Delta]tab"}], "]"}]}], ",", 
    RowBox[{"{", 
     RowBox[{"kt", ",", "kta", ",", " ", "ktb"}], "}"}]}], "]"}], " ", 
  "]"}], "\[IndentingNewLine]"}], "Input",
 CellChangeTimes->{{3.673633877024961*^9, 3.6736339048577547`*^9}, {
   3.6736339718029346`*^9, 3.673634033055626*^9}, {3.673634232386203*^9, 
   3.673634270877808*^9}, {3.6736346230683126`*^9, 3.673634623656871*^9}, {
   3.6736372412692127`*^9, 3.673637263134445*^9}, {3.673637912522444*^9, 
   3.673637914813155*^9}, {3.673639890255384*^9, 3.6736398995649967`*^9}, {
   3.673640471391406*^9, 3.673640483230631*^9}, {3.673640640137433*^9, 
   3.673640642952729*^9}, 3.673641646537736*^9, {3.6736443399559393`*^9, 
   3.673644392016801*^9}, {3.673644481396611*^9, 3.67364449921982*^9}, {
   3.673648208804284*^9, 3.67364821441127*^9}}],

Cell[BoxData[
 RowBox[{"ConditionalExpression", "[", 
  RowBox[{
   RowBox[{
    FractionBox["1", "\[Pi]"], 
    RowBox[{"(", 
     RowBox[{
      FractionBox[
       RowBox[{"2", " ", 
        RowBox[{"Cos", "[", 
         RowBox[{"kta", " ", "\[Delta]tab"}], "]"}]}], "kta"], "-", 
      FractionBox[
       RowBox[{"2", " ", 
        RowBox[{"Cos", "[", 
         RowBox[{"kta", " ", "\[Delta]t"}], "]"}], " ", 
        RowBox[{"Cos", "[", 
         RowBox[{"kta", " ", "\[Delta]tab"}], "]"}]}], "kta"], "-", 
      FractionBox[
       RowBox[{"2", " ", 
        RowBox[{"Cos", "[", 
         RowBox[{"ktb", " ", "\[Delta]tab"}], "]"}]}], "ktb"], "+", 
      FractionBox[
       RowBox[{"2", " ", 
        RowBox[{"Cos", "[", 
         RowBox[{"ktb", " ", "\[Delta]t"}], "]"}], " ", 
        RowBox[{"Cos", "[", 
         RowBox[{"ktb", " ", "\[Delta]tab"}], "]"}]}], "ktb"], "+", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{"-", "\[Delta]t"}], "+", "\[Delta]tab"}], ")"}], " ", 
       RowBox[{"SinIntegral", "[", 
        RowBox[{"kta", " ", 
         RowBox[{"(", 
          RowBox[{"\[Delta]t", "-", "\[Delta]tab"}], ")"}]}], "]"}]}], "+", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{"\[Delta]t", "-", "\[Delta]tab"}], ")"}], " ", 
       RowBox[{"SinIntegral", "[", 
        RowBox[{"ktb", " ", 
         RowBox[{"(", 
          RowBox[{"\[Delta]t", "-", "\[Delta]tab"}], ")"}]}], "]"}]}], "+", 
      RowBox[{"2", " ", "\[Delta]tab", " ", 
       RowBox[{"SinIntegral", "[", 
        RowBox[{"kta", " ", "\[Delta]tab"}], "]"}]}], "-", 
      RowBox[{"2", " ", "\[Delta]tab", " ", 
       RowBox[{"SinIntegral", "[", 
        RowBox[{"ktb", " ", "\[Delta]tab"}], "]"}]}], "-", 
      RowBox[{"\[Delta]t", " ", 
       RowBox[{"SinIntegral", "[", 
        RowBox[{"kta", " ", 
         RowBox[{"(", 
          RowBox[{"\[Delta]t", "+", "\[Delta]tab"}], ")"}]}], "]"}]}], "-", 
      RowBox[{"\[Delta]tab", " ", 
       RowBox[{"SinIntegral", "[", 
        RowBox[{"kta", " ", 
         RowBox[{"(", 
          RowBox[{"\[Delta]t", "+", "\[Delta]tab"}], ")"}]}], "]"}]}], "+", 
      RowBox[{"\[Delta]t", " ", 
       RowBox[{"SinIntegral", "[", 
        RowBox[{"ktb", " ", 
         RowBox[{"(", 
          RowBox[{"\[Delta]t", "+", "\[Delta]tab"}], ")"}]}], "]"}]}], "+", 
      RowBox[{"\[Delta]tab", " ", 
       RowBox[{"SinIntegral", "[", 
        RowBox[{"ktb", " ", 
         RowBox[{"(", 
          RowBox[{"\[Delta]t", "+", "\[Delta]tab"}], ")"}]}], "]"}]}]}], 
     ")"}]}], ",", 
   RowBox[{
    RowBox[{"(", 
     RowBox[{
      RowBox[{
       FractionBox["kta", 
        RowBox[{"kta", "-", "ktb"}]], "\[NotEqual]", "0"}], "&&", 
      RowBox[{
       RowBox[{"Re", "[", 
        FractionBox["kta", 
         RowBox[{
          RowBox[{"-", "kta"}], "+", "ktb"}]], "]"}], "\[GreaterEqual]", 
       "0"}]}], ")"}], "||", 
    RowBox[{
     RowBox[{"Re", "[", 
      FractionBox["kta", 
       RowBox[{"kta", "-", "ktb"}]], "]"}], ">", "1"}], "||", 
    RowBox[{
     FractionBox["kta", 
      RowBox[{"kta", "-", "ktb"}]], "\[NotElement]", "Reals"}]}]}], 
  "]"}]], "Output",
 CellChangeTimes->{3.6736445749546137`*^9, 3.67364824149118*^9}]
}, Closed]],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"mysinc", "[", "x_", "]"}], ":=", 
  RowBox[{
   RowBox[{"Sin", "[", 
    RowBox[{"\[Pi]", " ", "x"}], "]"}], "/", 
   RowBox[{"(", 
    RowBox[{"\[Pi]", " ", "x"}], ")"}]}]}], "\[IndentingNewLine]", 
 RowBox[{"Simplify", "[", " ", 
  RowBox[{"Integrate", "[", 
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{
       RowBox[{"(", 
        RowBox[{"\[Delta]t", "  ", 
         RowBox[{"mysinc", "[", 
          RowBox[{"\[Delta]t", " ", 
           RowBox[{"kt", "/", 
            RowBox[{"(", 
             RowBox[{"2", " ", "\[Pi]"}], ")"}]}]}], "]"}]}], ")"}], "^", 
       "2"}], "/", 
      RowBox[{"(", 
       RowBox[{"2", "\[Pi]"}], ")"}]}], " ", "2", " ", 
     RowBox[{"Sin", "[", " ", 
      RowBox[{"kt", " ", "\[Delta]tab"}], "]"}]}], ",", 
    RowBox[{"{", 
     RowBox[{"kt", ",", "kta", ",", " ", "ktb"}], "}"}]}], "]"}], " ", 
  "]"}]}], "Input",
 CellChangeTimes->{
  3.673648224696868*^9, {3.674825386231395*^9, 3.674825415604265*^9}, 
   3.674825470984408*^9}],

Cell[BoxData[
 RowBox[{"ConditionalExpression", "[", 
  RowBox[{
   RowBox[{
    FractionBox["1", 
     RowBox[{"kta", " ", "ktb", " ", "\[Pi]"}]], 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"kta", " ", "ktb", " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"-", "\[Delta]t"}], "+", "\[Delta]tab"}], ")"}], " ", 
       RowBox[{"CosIntegral", "[", 
        RowBox[{"kta", " ", 
         RowBox[{"(", 
          RowBox[{"\[Delta]t", "-", "\[Delta]tab"}], ")"}]}], "]"}]}], "+", 
      RowBox[{"kta", " ", "ktb", " ", 
       RowBox[{"(", 
        RowBox[{"\[Delta]t", "-", "\[Delta]tab"}], ")"}], " ", 
       RowBox[{"CosIntegral", "[", 
        RowBox[{"ktb", " ", 
         RowBox[{"(", 
          RowBox[{"\[Delta]t", "-", "\[Delta]tab"}], ")"}]}], "]"}]}], "-", 
      RowBox[{"2", " ", "kta", " ", "ktb", " ", "\[Delta]tab", " ", 
       RowBox[{"CosIntegral", "[", 
        RowBox[{"kta", " ", "\[Delta]tab"}], "]"}]}], "+", 
      RowBox[{"2", " ", "kta", " ", "ktb", " ", "\[Delta]tab", " ", 
       RowBox[{"CosIntegral", "[", 
        RowBox[{"ktb", " ", "\[Delta]tab"}], "]"}]}], "+", 
      RowBox[{"kta", " ", "ktb", " ", "\[Delta]t", " ", 
       RowBox[{"CosIntegral", "[", 
        RowBox[{"kta", " ", 
         RowBox[{"(", 
          RowBox[{"\[Delta]t", "+", "\[Delta]tab"}], ")"}]}], "]"}]}], "+", 
      RowBox[{"kta", " ", "ktb", " ", "\[Delta]tab", " ", 
       RowBox[{"CosIntegral", "[", 
        RowBox[{"kta", " ", 
         RowBox[{"(", 
          RowBox[{"\[Delta]t", "+", "\[Delta]tab"}], ")"}]}], "]"}]}], "-", 
      RowBox[{"kta", " ", "ktb", " ", "\[Delta]t", " ", 
       RowBox[{"CosIntegral", "[", 
        RowBox[{"ktb", " ", 
         RowBox[{"(", 
          RowBox[{"\[Delta]t", "+", "\[Delta]tab"}], ")"}]}], "]"}]}], "-", 
      RowBox[{"kta", " ", "ktb", " ", "\[Delta]tab", " ", 
       RowBox[{"CosIntegral", "[", 
        RowBox[{"ktb", " ", 
         RowBox[{"(", 
          RowBox[{"\[Delta]t", "+", "\[Delta]tab"}], ")"}]}], "]"}]}], "+", 
      RowBox[{"2", " ", "ktb", " ", 
       RowBox[{"Sin", "[", 
        RowBox[{"kta", " ", "\[Delta]tab"}], "]"}]}], "-", 
      RowBox[{"2", " ", "ktb", " ", 
       RowBox[{"Cos", "[", 
        RowBox[{"kta", " ", "\[Delta]t"}], "]"}], " ", 
       RowBox[{"Sin", "[", 
        RowBox[{"kta", " ", "\[Delta]tab"}], "]"}]}], "-", 
      RowBox[{"2", " ", "kta", " ", 
       RowBox[{"Sin", "[", 
        RowBox[{"ktb", " ", "\[Delta]tab"}], "]"}]}], "+", 
      RowBox[{"2", " ", "kta", " ", 
       RowBox[{"Cos", "[", 
        RowBox[{"ktb", " ", "\[Delta]t"}], "]"}], " ", 
       RowBox[{"Sin", "[", 
        RowBox[{"ktb", " ", "\[Delta]tab"}], "]"}]}]}], ")"}]}], ",", 
   RowBox[{
    RowBox[{"(", 
     RowBox[{
      RowBox[{
       RowBox[{"Re", "[", 
        FractionBox["kta", 
         RowBox[{"kta", "-", "ktb"}]], "]"}], ">", "1"}], "&&", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{
          RowBox[{
           RowBox[{"Re", "[", 
            FractionBox["kta", 
             RowBox[{"kta", "-", "ktb"}]], "]"}], "\[GreaterEqual]", "1"}], "&&", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"(", 
             RowBox[{
              RowBox[{
               RowBox[{
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{"-", 
                   RowBox[{"Im", "[", "\[Delta]t", "]"}]}], "+", 
                  RowBox[{"Im", "[", "\[Delta]tab", "]"}]}], ")"}], " ", 
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{"Re", "[", "kta", "]"}], "-", 
                  RowBox[{"Re", "[", "ktb", "]"}]}], ")"}]}], 
               "\[GreaterEqual]", 
               RowBox[{
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{"Im", "[", "kta", "]"}], "-", 
                  RowBox[{"Im", "[", "ktb", "]"}]}], ")"}], " ", 
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{"Re", "[", "\[Delta]t", "]"}], "-", 
                  RowBox[{"Re", "[", "\[Delta]tab", "]"}]}], ")"}]}]}], "&&", 
              
              RowBox[{
               RowBox[{
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{
                   RowBox[{"Im", "[", "ktb", "]"}], " ", 
                   RowBox[{"Re", "[", "kta", "]"}]}], "-", 
                  RowBox[{
                   RowBox[{"Im", "[", "kta", "]"}], " ", 
                   RowBox[{"Re", "[", "ktb", "]"}]}]}], ")"}], " ", 
                RowBox[{"(", 
                 RowBox[{
                  SuperscriptBox[
                   RowBox[{"Im", "[", "\[Delta]t", "]"}], "2"], "-", 
                  RowBox[{"2", " ", 
                   RowBox[{"Im", "[", "\[Delta]t", "]"}], " ", 
                   RowBox[{"Im", "[", "\[Delta]tab", "]"}]}], "+", 
                  SuperscriptBox[
                   RowBox[{"Im", "[", "\[Delta]tab", "]"}], "2"], "+", 
                  SuperscriptBox[
                   RowBox[{"(", 
                    RowBox[{
                    RowBox[{"Re", "[", "\[Delta]t", "]"}], "-", 
                    RowBox[{"Re", "[", "\[Delta]tab", "]"}]}], ")"}], "2"]}], 
                 ")"}]}], "\[GreaterEqual]", "0"}]}], ")"}], "||", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{
               RowBox[{
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{"-", 
                   RowBox[{"Im", "[", "\[Delta]t", "]"}]}], "+", 
                  RowBox[{"Im", "[", "\[Delta]tab", "]"}]}], ")"}], " ", 
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{"Re", "[", "kta", "]"}], "-", 
                  RowBox[{"Re", "[", "ktb", "]"}]}], ")"}]}], "\[LessEqual]", 
               
               RowBox[{
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{"Im", "[", "kta", "]"}], "-", 
                  RowBox[{"Im", "[", "ktb", "]"}]}], ")"}], " ", 
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{"Re", "[", "\[Delta]t", "]"}], "-", 
                  RowBox[{"Re", "[", "\[Delta]tab", "]"}]}], ")"}]}]}], "&&", 
              
              RowBox[{
               RowBox[{
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{
                   RowBox[{"Im", "[", "ktb", "]"}], " ", 
                   RowBox[{"Re", "[", "kta", "]"}]}], "-", 
                  RowBox[{
                   RowBox[{"Im", "[", "kta", "]"}], " ", 
                   RowBox[{"Re", "[", "ktb", "]"}]}]}], ")"}], " ", 
                RowBox[{"(", 
                 RowBox[{
                  SuperscriptBox[
                   RowBox[{"Im", "[", "\[Delta]t", "]"}], "2"], "-", 
                  RowBox[{"2", " ", 
                   RowBox[{"Im", "[", "\[Delta]t", "]"}], " ", 
                   RowBox[{"Im", "[", "\[Delta]tab", "]"}]}], "+", 
                  SuperscriptBox[
                   RowBox[{"Im", "[", "\[Delta]tab", "]"}], "2"], "+", 
                  SuperscriptBox[
                   RowBox[{"(", 
                    RowBox[{
                    RowBox[{"Re", "[", "\[Delta]t", "]"}], "-", 
                    RowBox[{"Re", "[", "\[Delta]tab", "]"}]}], ")"}], "2"]}], 
                 ")"}]}], "\[LessEqual]", "0"}]}], ")"}]}], ")"}]}], ")"}], "||", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{
           RowBox[{
            RowBox[{
             RowBox[{"Im", "[", "\[Delta]t", "]"}], " ", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{"Re", "[", "kta", "]"}], "-", 
               RowBox[{"Re", "[", "ktb", "]"}]}], ")"}]}], "+", 
            RowBox[{
             RowBox[{"Im", "[", "\[Delta]tab", "]"}], " ", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{"-", 
                RowBox[{"Re", "[", "kta", "]"}]}], "+", 
               RowBox[{"Re", "[", "ktb", "]"}]}], ")"}]}], "+", 
            RowBox[{
             RowBox[{"(", 
              RowBox[{
               RowBox[{"Im", "[", "kta", "]"}], "-", 
               RowBox[{"Im", "[", "ktb", "]"}]}], ")"}], " ", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{"Re", "[", "\[Delta]t", "]"}], "-", 
               RowBox[{"Re", "[", "\[Delta]tab", "]"}]}], ")"}]}]}], 
           "\[LessEqual]", "0"}], "&&", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{
             RowBox[{
              RowBox[{
               RowBox[{"Im", "[", "\[Delta]t", "]"}], " ", 
               RowBox[{"Re", "[", "kta", "]"}]}], "+", 
              RowBox[{
               RowBox[{"Im", "[", "kta", "]"}], " ", 
               RowBox[{"Re", "[", "\[Delta]t", "]"}]}]}], "\[GreaterEqual]", 
             RowBox[{
              RowBox[{
               RowBox[{"Im", "[", "\[Delta]tab", "]"}], " ", 
               RowBox[{"Re", "[", "kta", "]"}]}], "+", 
              RowBox[{
               RowBox[{"Im", "[", "kta", "]"}], " ", 
               RowBox[{"Re", "[", "\[Delta]tab", "]"}]}]}]}], "||", 
            RowBox[{
             RowBox[{
              RowBox[{
               RowBox[{"Im", "[", "\[Delta]t", "]"}], " ", 
               RowBox[{"Re", "[", "ktb", "]"}]}], "+", 
              RowBox[{
               RowBox[{"Im", "[", "ktb", "]"}], " ", 
               RowBox[{"Re", "[", "\[Delta]t", "]"}]}]}], "\[LessEqual]", 
             RowBox[{
              RowBox[{
               RowBox[{"Im", "[", "\[Delta]tab", "]"}], " ", 
               RowBox[{"Re", "[", "ktb", "]"}]}], "+", 
              RowBox[{
               RowBox[{"Im", "[", "ktb", "]"}], " ", 
               RowBox[{"Re", "[", "\[Delta]tab", "]"}]}]}]}]}], ")"}]}], 
         ")"}], "||", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{
           RowBox[{
            RowBox[{
             RowBox[{"Im", "[", "\[Delta]t", "]"}], " ", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{"Re", "[", "kta", "]"}], "-", 
               RowBox[{"Re", "[", "ktb", "]"}]}], ")"}]}], "+", 
            RowBox[{
             RowBox[{"Im", "[", "\[Delta]tab", "]"}], " ", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{"-", 
                RowBox[{"Re", "[", "kta", "]"}]}], "+", 
               RowBox[{"Re", "[", "ktb", "]"}]}], ")"}]}], "+", 
            RowBox[{
             RowBox[{"(", 
              RowBox[{
               RowBox[{"Im", "[", "kta", "]"}], "-", 
               RowBox[{"Im", "[", "ktb", "]"}]}], ")"}], " ", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{"Re", "[", "\[Delta]t", "]"}], "-", 
               RowBox[{"Re", "[", "\[Delta]tab", "]"}]}], ")"}]}]}], 
           "\[GreaterEqual]", "0"}], "&&", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{
             RowBox[{
              RowBox[{
               RowBox[{"Im", "[", "\[Delta]t", "]"}], " ", 
               RowBox[{"Re", "[", "ktb", "]"}]}], "+", 
              RowBox[{
               RowBox[{"Im", "[", "ktb", "]"}], " ", 
               RowBox[{"Re", "[", "\[Delta]t", "]"}]}]}], "\[GreaterEqual]", 
             RowBox[{
              RowBox[{
               RowBox[{"Im", "[", "\[Delta]tab", "]"}], " ", 
               RowBox[{"Re", "[", "ktb", "]"}]}], "+", 
              RowBox[{
               RowBox[{"Im", "[", "ktb", "]"}], " ", 
               RowBox[{"Re", "[", "\[Delta]tab", "]"}]}]}]}], "||", 
            RowBox[{
             RowBox[{
              RowBox[{
               RowBox[{"Im", "[", "\[Delta]t", "]"}], " ", 
               RowBox[{"Re", "[", "kta", "]"}]}], "+", 
              RowBox[{
               RowBox[{"Im", "[", "kta", "]"}], " ", 
               RowBox[{"Re", "[", "\[Delta]t", "]"}]}]}], "\[LessEqual]", 
             RowBox[{
              RowBox[{
               RowBox[{"Im", "[", "\[Delta]tab", "]"}], " ", 
               RowBox[{"Re", "[", "kta", "]"}]}], "+", 
              RowBox[{
               RowBox[{"Im", "[", "kta", "]"}], " ", 
               RowBox[{"Re", "[", "\[Delta]tab", "]"}]}]}]}]}], ")"}]}], 
         ")"}]}], ")"}]}], ")"}], "||", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{
       RowBox[{"Re", "[", 
        FractionBox["kta", 
         RowBox[{
          RowBox[{"-", "kta"}], "+", "ktb"}]], "]"}], "\[GreaterEqual]", 
       "0"}], "&&", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{
            RowBox[{"(", 
             RowBox[{
              RowBox[{
               RowBox[{
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{"-", 
                   RowBox[{"Im", "[", "\[Delta]t", "]"}]}], "+", 
                  RowBox[{"Im", "[", "\[Delta]tab", "]"}]}], ")"}], " ", 
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{"Re", "[", "kta", "]"}], "-", 
                  RowBox[{"Re", "[", "ktb", "]"}]}], ")"}]}], 
               "\[GreaterEqual]", 
               RowBox[{
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{"Im", "[", "kta", "]"}], "-", 
                  RowBox[{"Im", "[", "ktb", "]"}]}], ")"}], " ", 
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{"Re", "[", "\[Delta]t", "]"}], "-", 
                  RowBox[{"Re", "[", "\[Delta]tab", "]"}]}], ")"}]}]}], "&&", 
              
              RowBox[{
               RowBox[{
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{
                   RowBox[{"Im", "[", "ktb", "]"}], " ", 
                   RowBox[{"Re", "[", "kta", "]"}]}], "-", 
                  RowBox[{
                   RowBox[{"Im", "[", "kta", "]"}], " ", 
                   RowBox[{"Re", "[", "ktb", "]"}]}]}], ")"}], " ", 
                RowBox[{"(", 
                 RowBox[{
                  SuperscriptBox[
                   RowBox[{"Im", "[", "\[Delta]t", "]"}], "2"], "-", 
                  RowBox[{"2", " ", 
                   RowBox[{"Im", "[", "\[Delta]t", "]"}], " ", 
                   RowBox[{"Im", "[", "\[Delta]tab", "]"}]}], "+", 
                  SuperscriptBox[
                   RowBox[{"Im", "[", "\[Delta]tab", "]"}], "2"], "+", 
                  SuperscriptBox[
                   RowBox[{"(", 
                    RowBox[{
                    RowBox[{"Re", "[", "\[Delta]t", "]"}], "-", 
                    RowBox[{"Re", "[", "\[Delta]tab", "]"}]}], ")"}], "2"]}], 
                 ")"}]}], "\[GreaterEqual]", "0"}]}], ")"}], "||", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{
               RowBox[{
                RowBox[{
                 RowBox[{"Im", "[", "\[Delta]t", "]"}], " ", 
                 RowBox[{"(", 
                  RowBox[{
                   RowBox[{"Re", "[", "kta", "]"}], "-", 
                   RowBox[{"Re", "[", "ktb", "]"}]}], ")"}]}], "+", 
                RowBox[{
                 RowBox[{"Im", "[", "\[Delta]tab", "]"}], " ", 
                 RowBox[{"(", 
                  RowBox[{
                   RowBox[{"-", 
                    RowBox[{"Re", "[", "kta", "]"}]}], "+", 
                   RowBox[{"Re", "[", "ktb", "]"}]}], ")"}]}], "+", 
                RowBox[{
                 RowBox[{"(", 
                  RowBox[{
                   RowBox[{"Im", "[", "kta", "]"}], "-", 
                   RowBox[{"Im", "[", "ktb", "]"}]}], ")"}], " ", 
                 RowBox[{"(", 
                  RowBox[{
                   RowBox[{"Re", "[", "\[Delta]t", "]"}], "-", 
                   RowBox[{"Re", "[", "\[Delta]tab", "]"}]}], ")"}]}]}], 
               "\[GreaterEqual]", "0"}], "&&", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{
                 RowBox[{
                  RowBox[{
                   RowBox[{"Im", "[", "\[Delta]t", "]"}], " ", 
                   RowBox[{"Re", "[", "ktb", "]"}]}], "+", 
                  RowBox[{
                   RowBox[{"Im", "[", "ktb", "]"}], " ", 
                   RowBox[{"Re", "[", "\[Delta]t", "]"}]}]}], 
                 "\[GreaterEqual]", 
                 RowBox[{
                  RowBox[{
                   RowBox[{"Im", "[", "\[Delta]tab", "]"}], " ", 
                   RowBox[{"Re", "[", "ktb", "]"}]}], "+", 
                  RowBox[{
                   RowBox[{"Im", "[", "ktb", "]"}], " ", 
                   RowBox[{"Re", "[", "\[Delta]tab", "]"}]}]}]}], "||", 
                RowBox[{
                 RowBox[{
                  RowBox[{
                   RowBox[{"Im", "[", "\[Delta]tab", "]"}], " ", 
                   RowBox[{"Re", "[", "kta", "]"}]}], "+", 
                  RowBox[{
                   RowBox[{"Im", "[", "kta", "]"}], " ", 
                   RowBox[{"Re", "[", "\[Delta]tab", "]"}]}]}], 
                 "\[GreaterEqual]", 
                 RowBox[{
                  RowBox[{
                   RowBox[{"Im", "[", "\[Delta]t", "]"}], " ", 
                   RowBox[{"Re", "[", "kta", "]"}]}], "+", 
                  RowBox[{
                   RowBox[{"Im", "[", "kta", "]"}], " ", 
                   RowBox[{"Re", "[", "\[Delta]t", "]"}]}]}]}]}], ")"}]}], 
             ")"}], "||", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{
               RowBox[{
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{"-", 
                   RowBox[{"Im", "[", "\[Delta]t", "]"}]}], "+", 
                  RowBox[{"Im", "[", "\[Delta]tab", "]"}]}], ")"}], " ", 
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{"Re", "[", "kta", "]"}], "-", 
                  RowBox[{"Re", "[", "ktb", "]"}]}], ")"}]}], "\[LessEqual]", 
               
               RowBox[{
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{"Im", "[", "kta", "]"}], "-", 
                  RowBox[{"Im", "[", "ktb", "]"}]}], ")"}], " ", 
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{"Re", "[", "\[Delta]t", "]"}], "-", 
                  RowBox[{"Re", "[", "\[Delta]tab", "]"}]}], ")"}]}]}], "&&", 
              
              RowBox[{
               RowBox[{
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{
                   RowBox[{"Im", "[", "ktb", "]"}], " ", 
                   RowBox[{"Re", "[", "kta", "]"}]}], "-", 
                  RowBox[{
                   RowBox[{"Im", "[", "kta", "]"}], " ", 
                   RowBox[{"Re", "[", "ktb", "]"}]}]}], ")"}], " ", 
                RowBox[{"(", 
                 RowBox[{
                  SuperscriptBox[
                   RowBox[{"Im", "[", "\[Delta]t", "]"}], "2"], "-", 
                  RowBox[{"2", " ", 
                   RowBox[{"Im", "[", "\[Delta]t", "]"}], " ", 
                   RowBox[{"Im", "[", "\[Delta]tab", "]"}]}], "+", 
                  SuperscriptBox[
                   RowBox[{"Im", "[", "\[Delta]tab", "]"}], "2"], "+", 
                  SuperscriptBox[
                   RowBox[{"(", 
                    RowBox[{
                    RowBox[{"Re", "[", "\[Delta]t", "]"}], "-", 
                    RowBox[{"Re", "[", "\[Delta]tab", "]"}]}], ")"}], "2"]}], 
                 ")"}]}], "\[LessEqual]", "0"}]}], ")"}], "||", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{
               RowBox[{
                RowBox[{
                 RowBox[{"Im", "[", "\[Delta]t", "]"}], " ", 
                 RowBox[{"(", 
                  RowBox[{
                   RowBox[{"Re", "[", "kta", "]"}], "-", 
                   RowBox[{"Re", "[", "ktb", "]"}]}], ")"}]}], "+", 
                RowBox[{
                 RowBox[{"Im", "[", "\[Delta]tab", "]"}], " ", 
                 RowBox[{"(", 
                  RowBox[{
                   RowBox[{"-", 
                    RowBox[{"Re", "[", "kta", "]"}]}], "+", 
                   RowBox[{"Re", "[", "ktb", "]"}]}], ")"}]}], "+", 
                RowBox[{
                 RowBox[{"(", 
                  RowBox[{
                   RowBox[{"Im", "[", "kta", "]"}], "-", 
                   RowBox[{"Im", "[", "ktb", "]"}]}], ")"}], " ", 
                 RowBox[{"(", 
                  RowBox[{
                   RowBox[{"Re", "[", "\[Delta]t", "]"}], "-", 
                   RowBox[{"Re", "[", "\[Delta]tab", "]"}]}], ")"}]}]}], 
               "\[LessEqual]", "0"}], "&&", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{
                 RowBox[{
                  RowBox[{
                   RowBox[{"Im", "[", "\[Delta]t", "]"}], " ", 
                   RowBox[{"Re", "[", "ktb", "]"}]}], "+", 
                  RowBox[{
                   RowBox[{"Im", "[", "ktb", "]"}], " ", 
                   RowBox[{"Re", "[", "\[Delta]t", "]"}]}]}], "\[LessEqual]", 
                 
                 RowBox[{
                  RowBox[{
                   RowBox[{"Im", "[", "\[Delta]tab", "]"}], " ", 
                   RowBox[{"Re", "[", "ktb", "]"}]}], "+", 
                  RowBox[{
                   RowBox[{"Im", "[", "ktb", "]"}], " ", 
                   RowBox[{"Re", "[", "\[Delta]tab", "]"}]}]}]}], "||", 
                RowBox[{
                 RowBox[{
                  RowBox[{
                   RowBox[{"Im", "[", "\[Delta]tab", "]"}], " ", 
                   RowBox[{"Re", "[", "kta", "]"}]}], "+", 
                  RowBox[{
                   RowBox[{"Im", "[", "kta", "]"}], " ", 
                   RowBox[{"Re", "[", "\[Delta]tab", "]"}]}]}], 
                 "\[LessEqual]", 
                 RowBox[{
                  RowBox[{
                   RowBox[{"Im", "[", "\[Delta]t", "]"}], " ", 
                   RowBox[{"Re", "[", "kta", "]"}]}], "+", 
                  RowBox[{
                   RowBox[{"Im", "[", "kta", "]"}], " ", 
                   RowBox[{"Re", "[", "\[Delta]t", "]"}]}]}]}]}], ")"}]}], 
             ")"}]}], ")"}], "&&", 
          RowBox[{
           FractionBox["kta", 
            RowBox[{"kta", "-", "ktb"}]], "\[NotEqual]", "0"}]}], ")"}], "||", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{
           RowBox[{"Re", "[", 
            FractionBox["kta", 
             RowBox[{"kta", "-", "ktb"}]], "]"}], ">", "1"}], "&&", 
          RowBox[{
           RowBox[{
            RowBox[{"(", 
             RowBox[{
              RowBox[{"-", 
               RowBox[{"Im", "[", "\[Delta]t", "]"}]}], "+", 
              RowBox[{"Im", "[", "\[Delta]tab", "]"}]}], ")"}], " ", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{"Re", "[", "kta", "]"}], "-", 
              RowBox[{"Re", "[", "ktb", "]"}]}], ")"}]}], "\[GreaterEqual]", 
           RowBox[{
            RowBox[{"(", 
             RowBox[{
              RowBox[{"Im", "[", "kta", "]"}], "-", 
              RowBox[{"Im", "[", "ktb", "]"}]}], ")"}], " ", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{"Re", "[", "\[Delta]t", "]"}], "-", 
              RowBox[{"Re", "[", "\[Delta]tab", "]"}]}], ")"}]}]}], "&&", 
          RowBox[{
           RowBox[{
            RowBox[{"(", 
             RowBox[{
              RowBox[{
               RowBox[{"Im", "[", "ktb", "]"}], " ", 
               RowBox[{"Re", "[", "kta", "]"}]}], "-", 
              RowBox[{
               RowBox[{"Im", "[", "kta", "]"}], " ", 
               RowBox[{"Re", "[", "ktb", "]"}]}]}], ")"}], " ", 
            RowBox[{"(", 
             RowBox[{
              SuperscriptBox[
               RowBox[{"Im", "[", "\[Delta]t", "]"}], "2"], "-", 
              RowBox[{"2", " ", 
               RowBox[{"Im", "[", "\[Delta]t", "]"}], " ", 
               RowBox[{"Im", "[", "\[Delta]tab", "]"}]}], "+", 
              SuperscriptBox[
               RowBox[{"Im", "[", "\[Delta]tab", "]"}], "2"], "+", 
              SuperscriptBox[
               RowBox[{"(", 
                RowBox[{
                 RowBox[{"Re", "[", "\[Delta]t", "]"}], "-", 
                 RowBox[{"Re", "[", "\[Delta]tab", "]"}]}], ")"}], "2"]}], 
             ")"}]}], "\[GreaterEqual]", "0"}]}], ")"}], "||", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{
           RowBox[{"Re", "[", 
            FractionBox["kta", 
             RowBox[{"kta", "-", "ktb"}]], "]"}], ">", "1"}], "&&", 
          RowBox[{
           RowBox[{
            RowBox[{
             RowBox[{"Im", "[", "\[Delta]t", "]"}], " ", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{"Re", "[", "kta", "]"}], "-", 
               RowBox[{"Re", "[", "ktb", "]"}]}], ")"}]}], "+", 
            RowBox[{
             RowBox[{"Im", "[", "\[Delta]tab", "]"}], " ", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{"-", 
                RowBox[{"Re", "[", "kta", "]"}]}], "+", 
               RowBox[{"Re", "[", "ktb", "]"}]}], ")"}]}], "+", 
            RowBox[{
             RowBox[{"(", 
              RowBox[{
               RowBox[{"Im", "[", "kta", "]"}], "-", 
               RowBox[{"Im", "[", "ktb", "]"}]}], ")"}], " ", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{"Re", "[", "\[Delta]t", "]"}], "-", 
               RowBox[{"Re", "[", "\[Delta]tab", "]"}]}], ")"}]}]}], 
           "\[GreaterEqual]", "0"}], "&&", 
          RowBox[{
           RowBox[{
            RowBox[{
             RowBox[{"Im", "[", "\[Delta]tab", "]"}], " ", 
             RowBox[{"Re", "[", "kta", "]"}]}], "+", 
            RowBox[{
             RowBox[{"Im", "[", "kta", "]"}], " ", 
             RowBox[{"Re", "[", "\[Delta]tab", "]"}]}]}], "\[GreaterEqual]", 
           RowBox[{
            RowBox[{
             RowBox[{"Im", "[", "\[Delta]t", "]"}], " ", 
             RowBox[{"Re", "[", "kta", "]"}]}], "+", 
            RowBox[{
             RowBox[{"Im", "[", "kta", "]"}], " ", 
             RowBox[{"Re", "[", "\[Delta]t", "]"}]}]}]}]}], ")"}], "||", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{
           RowBox[{"Re", "[", 
            FractionBox["kta", 
             RowBox[{"kta", "-", "ktb"}]], "]"}], ">", "1"}], "&&", 
          RowBox[{
           RowBox[{
            RowBox[{"(", 
             RowBox[{
              RowBox[{"-", 
               RowBox[{"Im", "[", "\[Delta]t", "]"}]}], "+", 
              RowBox[{"Im", "[", "\[Delta]tab", "]"}]}], ")"}], " ", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{"Re", "[", "kta", "]"}], "-", 
              RowBox[{"Re", "[", "ktb", "]"}]}], ")"}]}], "\[LessEqual]", 
           RowBox[{
            RowBox[{"(", 
             RowBox[{
              RowBox[{"Im", "[", "kta", "]"}], "-", 
              RowBox[{"Im", "[", "ktb", "]"}]}], ")"}], " ", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{"Re", "[", "\[Delta]t", "]"}], "-", 
              RowBox[{"Re", "[", "\[Delta]tab", "]"}]}], ")"}]}]}], "&&", 
          RowBox[{
           RowBox[{
            RowBox[{"(", 
             RowBox[{
              RowBox[{
               RowBox[{"Im", "[", "ktb", "]"}], " ", 
               RowBox[{"Re", "[", "kta", "]"}]}], "-", 
              RowBox[{
               RowBox[{"Im", "[", "kta", "]"}], " ", 
               RowBox[{"Re", "[", "ktb", "]"}]}]}], ")"}], " ", 
            RowBox[{"(", 
             RowBox[{
              SuperscriptBox[
               RowBox[{"Im", "[", "\[Delta]t", "]"}], "2"], "-", 
              RowBox[{"2", " ", 
               RowBox[{"Im", "[", "\[Delta]t", "]"}], " ", 
               RowBox[{"Im", "[", "\[Delta]tab", "]"}]}], "+", 
              SuperscriptBox[
               RowBox[{"Im", "[", "\[Delta]tab", "]"}], "2"], "+", 
              SuperscriptBox[
               RowBox[{"(", 
                RowBox[{
                 RowBox[{"Re", "[", "\[Delta]t", "]"}], "-", 
                 RowBox[{"Re", "[", "\[Delta]tab", "]"}]}], ")"}], "2"]}], 
             ")"}]}], "\[LessEqual]", "0"}]}], ")"}], "||", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{
           RowBox[{"Re", "[", 
            FractionBox["kta", 
             RowBox[{"kta", "-", "ktb"}]], "]"}], ">", "1"}], "&&", 
          RowBox[{
           RowBox[{
            RowBox[{
             RowBox[{"Im", "[", "\[Delta]t", "]"}], " ", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{"Re", "[", "kta", "]"}], "-", 
               RowBox[{"Re", "[", "ktb", "]"}]}], ")"}]}], "+", 
            RowBox[{
             RowBox[{"Im", "[", "\[Delta]tab", "]"}], " ", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{"-", 
                RowBox[{"Re", "[", "kta", "]"}]}], "+", 
               RowBox[{"Re", "[", "ktb", "]"}]}], ")"}]}], "+", 
            RowBox[{
             RowBox[{"(", 
              RowBox[{
               RowBox[{"Im", "[", "kta", "]"}], "-", 
               RowBox[{"Im", "[", "ktb", "]"}]}], ")"}], " ", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{"Re", "[", "\[Delta]t", "]"}], "-", 
               RowBox[{"Re", "[", "\[Delta]tab", "]"}]}], ")"}]}]}], 
           "\[LessEqual]", "0"}], "&&", 
          RowBox[{
           RowBox[{
            RowBox[{
             RowBox[{"Im", "[", "\[Delta]tab", "]"}], " ", 
             RowBox[{"Re", "[", "kta", "]"}]}], "+", 
            RowBox[{
             RowBox[{"Im", "[", "kta", "]"}], " ", 
             RowBox[{"Re", "[", "\[Delta]tab", "]"}]}]}], "\[LessEqual]", 
           RowBox[{
            RowBox[{
             RowBox[{"Im", "[", "\[Delta]t", "]"}], " ", 
             RowBox[{"Re", "[", "kta", "]"}]}], "+", 
            RowBox[{
             RowBox[{"Im", "[", "kta", "]"}], " ", 
             RowBox[{"Re", "[", "\[Delta]t", "]"}]}]}]}]}], ")"}]}], ")"}]}], 
     ")"}], "||", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{
       FractionBox["kta", 
        RowBox[{"kta", "-", "ktb"}]], "\[NotElement]", "Reals"}], "&&", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{
          RowBox[{
           RowBox[{
            RowBox[{"(", 
             RowBox[{
              RowBox[{"-", 
               RowBox[{"Im", "[", "\[Delta]t", "]"}]}], "+", 
              RowBox[{"Im", "[", "\[Delta]tab", "]"}]}], ")"}], " ", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{"Re", "[", "kta", "]"}], "-", 
              RowBox[{"Re", "[", "ktb", "]"}]}], ")"}]}], "\[GreaterEqual]", 
           RowBox[{
            RowBox[{"(", 
             RowBox[{
              RowBox[{"Im", "[", "kta", "]"}], "-", 
              RowBox[{"Im", "[", "ktb", "]"}]}], ")"}], " ", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{"Re", "[", "\[Delta]t", "]"}], "-", 
              RowBox[{"Re", "[", "\[Delta]tab", "]"}]}], ")"}]}]}], "&&", 
          RowBox[{
           RowBox[{
            RowBox[{"(", 
             RowBox[{
              RowBox[{
               RowBox[{"Im", "[", "ktb", "]"}], " ", 
               RowBox[{"Re", "[", "kta", "]"}]}], "-", 
              RowBox[{
               RowBox[{"Im", "[", "kta", "]"}], " ", 
               RowBox[{"Re", "[", "ktb", "]"}]}]}], ")"}], " ", 
            RowBox[{"(", 
             RowBox[{
              SuperscriptBox[
               RowBox[{"Im", "[", "\[Delta]t", "]"}], "2"], "-", 
              RowBox[{"2", " ", 
               RowBox[{"Im", "[", "\[Delta]t", "]"}], " ", 
               RowBox[{"Im", "[", "\[Delta]tab", "]"}]}], "+", 
              SuperscriptBox[
               RowBox[{"Im", "[", "\[Delta]tab", "]"}], "2"], "+", 
              SuperscriptBox[
               RowBox[{"(", 
                RowBox[{
                 RowBox[{"Re", "[", "\[Delta]t", "]"}], "-", 
                 RowBox[{"Re", "[", "\[Delta]tab", "]"}]}], ")"}], "2"]}], 
             ")"}]}], "\[GreaterEqual]", "0"}]}], ")"}], "||", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{
           RowBox[{
            RowBox[{
             RowBox[{"Im", "[", "\[Delta]t", "]"}], " ", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{"Re", "[", "kta", "]"}], "-", 
               RowBox[{"Re", "[", "ktb", "]"}]}], ")"}]}], "+", 
            RowBox[{
             RowBox[{"Im", "[", "\[Delta]tab", "]"}], " ", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{"-", 
                RowBox[{"Re", "[", "kta", "]"}]}], "+", 
               RowBox[{"Re", "[", "ktb", "]"}]}], ")"}]}], "+", 
            RowBox[{
             RowBox[{"(", 
              RowBox[{
               RowBox[{"Im", "[", "kta", "]"}], "-", 
               RowBox[{"Im", "[", "ktb", "]"}]}], ")"}], " ", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{"Re", "[", "\[Delta]t", "]"}], "-", 
               RowBox[{"Re", "[", "\[Delta]tab", "]"}]}], ")"}]}]}], 
           "\[GreaterEqual]", "0"}], "&&", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{
             RowBox[{
              RowBox[{
               RowBox[{"Im", "[", "\[Delta]t", "]"}], " ", 
               RowBox[{"Re", "[", "ktb", "]"}]}], "+", 
              RowBox[{
               RowBox[{"Im", "[", "ktb", "]"}], " ", 
               RowBox[{"Re", "[", "\[Delta]t", "]"}]}]}], "\[GreaterEqual]", 
             RowBox[{
              RowBox[{
               RowBox[{"Im", "[", "\[Delta]tab", "]"}], " ", 
               RowBox[{"Re", "[", "ktb", "]"}]}], "+", 
              RowBox[{
               RowBox[{"Im", "[", "ktb", "]"}], " ", 
               RowBox[{"Re", "[", "\[Delta]tab", "]"}]}]}]}], "||", 
            RowBox[{
             RowBox[{
              RowBox[{
               RowBox[{"Im", "[", "\[Delta]tab", "]"}], " ", 
               RowBox[{"Re", "[", "kta", "]"}]}], "+", 
              RowBox[{
               RowBox[{"Im", "[", "kta", "]"}], " ", 
               RowBox[{"Re", "[", "\[Delta]tab", "]"}]}]}], "\[GreaterEqual]", 
             RowBox[{
              RowBox[{
               RowBox[{"Im", "[", "\[Delta]t", "]"}], " ", 
               RowBox[{"Re", "[", "kta", "]"}]}], "+", 
              RowBox[{
               RowBox[{"Im", "[", "kta", "]"}], " ", 
               RowBox[{"Re", "[", "\[Delta]t", "]"}]}]}]}]}], ")"}]}], ")"}], 
        "||", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{
           RowBox[{
            RowBox[{"(", 
             RowBox[{
              RowBox[{"-", 
               RowBox[{"Im", "[", "\[Delta]t", "]"}]}], "+", 
              RowBox[{"Im", "[", "\[Delta]tab", "]"}]}], ")"}], " ", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{"Re", "[", "kta", "]"}], "-", 
              RowBox[{"Re", "[", "ktb", "]"}]}], ")"}]}], "\[LessEqual]", 
           RowBox[{
            RowBox[{"(", 
             RowBox[{
              RowBox[{"Im", "[", "kta", "]"}], "-", 
              RowBox[{"Im", "[", "ktb", "]"}]}], ")"}], " ", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{"Re", "[", "\[Delta]t", "]"}], "-", 
              RowBox[{"Re", "[", "\[Delta]tab", "]"}]}], ")"}]}]}], "&&", 
          RowBox[{
           RowBox[{
            RowBox[{"(", 
             RowBox[{
              RowBox[{
               RowBox[{"Im", "[", "ktb", "]"}], " ", 
               RowBox[{"Re", "[", "kta", "]"}]}], "-", 
              RowBox[{
               RowBox[{"Im", "[", "kta", "]"}], " ", 
               RowBox[{"Re", "[", "ktb", "]"}]}]}], ")"}], " ", 
            RowBox[{"(", 
             RowBox[{
              SuperscriptBox[
               RowBox[{"Im", "[", "\[Delta]t", "]"}], "2"], "-", 
              RowBox[{"2", " ", 
               RowBox[{"Im", "[", "\[Delta]t", "]"}], " ", 
               RowBox[{"Im", "[", "\[Delta]tab", "]"}]}], "+", 
              SuperscriptBox[
               RowBox[{"Im", "[", "\[Delta]tab", "]"}], "2"], "+", 
              SuperscriptBox[
               RowBox[{"(", 
                RowBox[{
                 RowBox[{"Re", "[", "\[Delta]t", "]"}], "-", 
                 RowBox[{"Re", "[", "\[Delta]tab", "]"}]}], ")"}], "2"]}], 
             ")"}]}], "\[LessEqual]", "0"}]}], ")"}], "||", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{
           RowBox[{
            RowBox[{
             RowBox[{"Im", "[", "\[Delta]t", "]"}], " ", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{"Re", "[", "kta", "]"}], "-", 
               RowBox[{"Re", "[", "ktb", "]"}]}], ")"}]}], "+", 
            RowBox[{
             RowBox[{"Im", "[", "\[Delta]tab", "]"}], " ", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{"-", 
                RowBox[{"Re", "[", "kta", "]"}]}], "+", 
               RowBox[{"Re", "[", "ktb", "]"}]}], ")"}]}], "+", 
            RowBox[{
             RowBox[{"(", 
              RowBox[{
               RowBox[{"Im", "[", "kta", "]"}], "-", 
               RowBox[{"Im", "[", "ktb", "]"}]}], ")"}], " ", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{"Re", "[", "\[Delta]t", "]"}], "-", 
               RowBox[{"Re", "[", "\[Delta]tab", "]"}]}], ")"}]}]}], 
           "\[LessEqual]", "0"}], "&&", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{
             RowBox[{
              RowBox[{
               RowBox[{"Im", "[", "\[Delta]t", "]"}], " ", 
               RowBox[{"Re", "[", "ktb", "]"}]}], "+", 
              RowBox[{
               RowBox[{"Im", "[", "ktb", "]"}], " ", 
               RowBox[{"Re", "[", "\[Delta]t", "]"}]}]}], "\[LessEqual]", 
             RowBox[{
              RowBox[{
               RowBox[{"Im", "[", "\[Delta]tab", "]"}], " ", 
               RowBox[{"Re", "[", "ktb", "]"}]}], "+", 
              RowBox[{
               RowBox[{"Im", "[", "ktb", "]"}], " ", 
               RowBox[{"Re", "[", "\[Delta]tab", "]"}]}]}]}], "||", 
            RowBox[{
             RowBox[{
              RowBox[{
               RowBox[{"Im", "[", "\[Delta]tab", "]"}], " ", 
               RowBox[{"Re", "[", "kta", "]"}]}], "+", 
              RowBox[{
               RowBox[{"Im", "[", "kta", "]"}], " ", 
               RowBox[{"Re", "[", "\[Delta]tab", "]"}]}]}], "\[LessEqual]", 
             RowBox[{
              RowBox[{
               RowBox[{"Im", "[", "\[Delta]t", "]"}], " ", 
               RowBox[{"Re", "[", "kta", "]"}]}], "+", 
              RowBox[{
               RowBox[{"Im", "[", "kta", "]"}], " ", 
               RowBox[{"Re", "[", "\[Delta]t", "]"}]}]}]}]}], ")"}]}], 
         ")"}]}], ")"}]}], ")"}]}]}], "]"}]], "Output",
 CellChangeTimes->{3.674825524501916*^9, 3.675956788040325*^9}]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Given analytical solution", "Chapter",
 CellChangeTimes->{{3.673641389412755*^9, 3.673641403254572*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"dcovReal", "[", 
     RowBox[{"kta_", ",", "ktb_", ",", "\[Delta]t_", ",", "\[Delta]tab_"}], 
     "]"}], ":=", 
    RowBox[{
     FractionBox["1", "\[Pi]"], 
     RowBox[{"(", 
      RowBox[{
       FractionBox[
        RowBox[{"2", " ", 
         RowBox[{"Cos", "[", 
          RowBox[{"kta", " ", "\[Delta]tab"}], "]"}]}], "kta"], "-", 
       FractionBox[
        RowBox[{"2", " ", 
         RowBox[{"Cos", "[", 
          RowBox[{"kta", " ", "\[Delta]t"}], "]"}], " ", 
         RowBox[{"Cos", "[", 
          RowBox[{"kta", " ", "\[Delta]tab"}], "]"}]}], "kta"], "-", 
       FractionBox[
        RowBox[{"2", " ", 
         RowBox[{"Cos", "[", 
          RowBox[{"ktb", " ", "\[Delta]tab"}], "]"}]}], "ktb"], "+", 
       FractionBox[
        RowBox[{"2", " ", 
         RowBox[{"Cos", "[", 
          RowBox[{"ktb", " ", "\[Delta]t"}], "]"}], " ", 
         RowBox[{"Cos", "[", 
          RowBox[{"ktb", " ", "\[Delta]tab"}], "]"}]}], "ktb"], "+", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{
          RowBox[{"-", "\[Delta]t"}], "+", "\[Delta]tab"}], ")"}], " ", 
        RowBox[{"SinIntegral", "[", 
         RowBox[{"kta", " ", 
          RowBox[{"(", 
           RowBox[{"\[Delta]t", "-", "\[Delta]tab"}], ")"}]}], "]"}]}], "+", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{"\[Delta]t", "-", "\[Delta]tab"}], ")"}], " ", 
        RowBox[{"SinIntegral", "[", 
         RowBox[{"ktb", " ", 
          RowBox[{"(", 
           RowBox[{"\[Delta]t", "-", "\[Delta]tab"}], ")"}]}], "]"}]}], "+", 
       RowBox[{"2", " ", "\[Delta]tab", " ", 
        RowBox[{"SinIntegral", "[", 
         RowBox[{"kta", " ", "\[Delta]tab"}], "]"}]}], "-", 
       RowBox[{"2", " ", "\[Delta]tab", " ", 
        RowBox[{"SinIntegral", "[", 
         RowBox[{"ktb", " ", "\[Delta]tab"}], "]"}]}], "-", 
       RowBox[{"\[Delta]t", " ", 
        RowBox[{"SinIntegral", "[", 
         RowBox[{"kta", " ", 
          RowBox[{"(", 
           RowBox[{"\[Delta]t", "+", "\[Delta]tab"}], ")"}]}], "]"}]}], "-", 
       RowBox[{"\[Delta]tab", " ", 
        RowBox[{"SinIntegral", "[", 
         RowBox[{"kta", " ", 
          RowBox[{"(", 
           RowBox[{"\[Delta]t", "+", "\[Delta]tab"}], ")"}]}], "]"}]}], "+", 
       RowBox[{"\[Delta]t", " ", 
        RowBox[{"SinIntegral", "[", 
         RowBox[{"ktb", " ", 
          RowBox[{"(", 
           RowBox[{"\[Delta]t", "+", "\[Delta]tab"}], ")"}]}], "]"}]}], "+", 
       RowBox[{"\[Delta]tab", " ", 
        RowBox[{"SinIntegral", "[", 
         RowBox[{"ktb", " ", 
          RowBox[{"(", 
           RowBox[{"\[Delta]t", "+", "\[Delta]tab"}], ")"}]}], "]"}]}]}], 
      ")"}]}]}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"dcovImag", "[", 
     RowBox[{"kta_", ",", "ktb_", ",", "\[Delta]t_", ",", "\[Delta]tab_"}], 
     "]"}], ":=", 
    RowBox[{
     FractionBox["1", 
      RowBox[{"kta", " ", "ktb", " ", "\[Pi]"}]], 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"kta", " ", "ktb", " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"-", "\[Delta]t"}], "+", "\[Delta]tab"}], ")"}], " ", 
        RowBox[{"CosIntegral", "[", 
         RowBox[{"kta", " ", 
          RowBox[{"(", 
           RowBox[{"\[Delta]t", "-", "\[Delta]tab"}], ")"}]}], "]"}]}], "+", 
       RowBox[{"kta", " ", "ktb", " ", 
        RowBox[{"(", 
         RowBox[{"\[Delta]t", "-", "\[Delta]tab"}], ")"}], " ", 
        RowBox[{"CosIntegral", "[", 
         RowBox[{"ktb", " ", 
          RowBox[{"(", 
           RowBox[{"\[Delta]t", "-", "\[Delta]tab"}], ")"}]}], "]"}]}], "-", 
       RowBox[{"2", " ", "kta", " ", "ktb", " ", "\[Delta]tab", " ", 
        RowBox[{"CosIntegral", "[", 
         RowBox[{"kta", " ", "\[Delta]tab"}], "]"}]}], "+", 
       RowBox[{"2", " ", "kta", " ", "ktb", " ", "\[Delta]tab", " ", 
        RowBox[{"CosIntegral", "[", 
         RowBox[{"ktb", " ", "\[Delta]tab"}], "]"}]}], "+", 
       RowBox[{"kta", " ", "ktb", " ", "\[Delta]t", " ", 
        RowBox[{"CosIntegral", "[", 
         RowBox[{"kta", " ", 
          RowBox[{"(", 
           RowBox[{"\[Delta]t", "+", "\[Delta]tab"}], ")"}]}], "]"}]}], "+", 
       RowBox[{"kta", " ", "ktb", " ", "\[Delta]tab", " ", 
        RowBox[{"CosIntegral", "[", 
         RowBox[{"kta", " ", 
          RowBox[{"(", 
           RowBox[{"\[Delta]t", "+", "\[Delta]tab"}], ")"}]}], "]"}]}], "-", 
       RowBox[{"kta", " ", "ktb", " ", "\[Delta]t", " ", 
        RowBox[{"CosIntegral", "[", 
         RowBox[{"ktb", " ", 
          RowBox[{"(", 
           RowBox[{"\[Delta]t", "+", "\[Delta]tab"}], ")"}]}], "]"}]}], "-", 
       RowBox[{"kta", " ", "ktb", " ", "\[Delta]tab", " ", 
        RowBox[{"CosIntegral", "[", 
         RowBox[{"ktb", " ", 
          RowBox[{"(", 
           RowBox[{"\[Delta]t", "+", "\[Delta]tab"}], ")"}]}], "]"}]}], "+", 
       RowBox[{"2", " ", "ktb", " ", 
        RowBox[{"Sin", "[", 
         RowBox[{"kta", " ", "\[Delta]tab"}], "]"}]}], "-", 
       RowBox[{"2", " ", "ktb", " ", 
        RowBox[{"Cos", "[", 
         RowBox[{"kta", " ", "\[Delta]t"}], "]"}], " ", 
        RowBox[{"Sin", "[", 
         RowBox[{"kta", " ", "\[Delta]tab"}], "]"}]}], "-", 
       RowBox[{"2", " ", "kta", " ", 
        RowBox[{"Sin", "[", 
         RowBox[{"ktb", " ", "\[Delta]tab"}], "]"}]}], "+", 
       RowBox[{"2", " ", "kta", " ", 
        RowBox[{"Cos", "[", 
         RowBox[{"ktb", " ", "\[Delta]t"}], "]"}], " ", 
        RowBox[{"Sin", "[", 
         RowBox[{"ktb", " ", "\[Delta]tab"}], "]"}]}]}], ")"}]}]}], 
   "\[IndentingNewLine]", "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{"resReal", "=", 
    RowBox[{"FortranForm", "[", 
     RowBox[{"FullSimplify", "[", 
      RowBox[{"dcovReal", "[", 
       RowBox[{"ktia", ",", "ktib", ",", "dt", ",", "dtab"}], "]"}], "]"}], 
     "]"}]}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
   "\[IndentingNewLine]"}]}]], "Input",
 CellChangeTimes->{{3.673641405055328*^9, 3.6736414057239847`*^9}, 
   3.673644636019806*^9, 3.673648429218688*^9, {3.67482537347904*^9, 
   3.674825374380438*^9}, {3.674825439327425*^9, 3.674825448618321*^9}, 
   3.6748256664545507`*^9, {3.675457588094986*^9, 3.675457638908514*^9}, {
   3.675457822289495*^9, 3.675457869138505*^9}, 3.675957034502337*^9, {
   3.6759571646197243`*^9, 3.6759572138653603`*^9}, 3.675957260894805*^9}],

Cell["\<\
        (-2*ktib*(-1 + Cos(dt*ktia))*Cos(dtab*ktia) + 
     -    2*ktia*(-1 + Cos(dt*ktib))*Cos(dtab*ktib) + 
     -    (-dt + dtab)*ktia*ktib*SinIntegral((dt - dtab)*ktia) + 
     -    2*dtab*ktia*ktib*SinIntegral(dtab*ktia) - 
     -    ktia*ktib*((dt + dtab)*SinIntegral((dt + dtab)*ktia) + 
     -       (-dt + dtab)*SinIntegral((dt - dtab)*ktib) + \
2*dtab*SinIntegral(dtab*ktib)
     -       ) + (dt + dtab)*ktia*ktib*SinIntegral((dt + \
dtab)*ktib))/(ktia*ktib*Pi)\
\>", "Output",
 CellChangeTimes->{{3.6754575903956003`*^9, 3.675457627748446*^9}, {
   3.675457814961976*^9, 3.6754578433473663`*^9}, 3.675457878100568*^9, 
   3.67546099506406*^9, 3.675957236406169*^9, 3.67595728213922*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"resImag", "=", 
  RowBox[{"FortranForm", "[", 
   RowBox[{"Simplify", "[", 
    RowBox[{"dcovImag", "[", 
     RowBox[{"ktia", ",", "ktib", ",", "dt", ",", "dtab"}], "]"}], "]"}], 
   "]"}]}]], "Input"],

Cell["\<\
        ((-dt + dtab)*ktia*ktib*CosIntegral((dt - dtab)*ktia) - 
     -    2*dtab*ktia*ktib*CosIntegral(dtab*ktia) + 
     -    dt*ktia*ktib*CosIntegral((dt + dtab)*ktia) + 
     -    dtab*ktia*ktib*CosIntegral((dt + dtab)*ktia) + 
     -    (dt - dtab)*ktia*ktib*CosIntegral((dt - dtab)*ktib) + 
     -    2*dtab*ktia*ktib*CosIntegral(dtab*ktib) - 
     -    dt*ktia*ktib*CosIntegral((dt + dtab)*ktib) - 
     -    dtab*ktia*ktib*CosIntegral((dt + dtab)*ktib) + \
2*ktib*Sin(dtab*ktia) - 
     -    2*ktib*Cos(dt*ktia)*Sin(dtab*ktia) - 2*ktia*Sin(dtab*ktib) + 
     -    2*ktia*Cos(dt*ktib)*Sin(dtab*ktib))/(ktia*ktib*Pi)\
\>", "Output",
 CellChangeTimes->{{3.6759572633685093`*^9, 3.675957289113834*^9}}]
}, Open  ]]
}, Open  ]]
}, Open  ]]
},
WindowSize->{808, 755},
WindowMargins->{{Automatic, 70}, {Automatic, 0}},
FrontEndVersion->"10.3 for Mac OS X x86 (32-bit, 64-bit Kernel) (October 9, \
2015)",
StyleDefinitions->"Default.nb"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[CellGroupData[{
Cell[580, 22, 100, 1, 92, "Title"],
Cell[CellGroupData[{
Cell[705, 27, 171, 2, 65, "Chapter"],
Cell[CellGroupData[{
Cell[901, 33, 1562, 37, 63, "Input"],
Cell[2466, 72, 3198, 89, 210, "Output"]
}, Closed]],
Cell[CellGroupData[{
Cell[5701, 166, 1020, 31, 40, "Input"],
Cell[6724, 199, 38554, 955, 1358, "Output"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[45327, 1160, 110, 1, 65, "Chapter"],
Cell[CellGroupData[{
Cell[45462, 1165, 6380, 152, 471, "Input"],
Cell[51845, 1319, 707, 13, 130, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[52589, 1337, 226, 6, 28, "Input"],
Cell[52818, 1345, 716, 13, 175, "Output"]
}, Open  ]]
}, Open  ]]
}, Open  ]]
}
]
*)

(* End of internal cache information *)
